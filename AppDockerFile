FROM node:10.16-alpine

WORKDIR /app

# Install bash to wait-for-it script
RUN apk update && apk add bash

# Move app startup script to its properly folder
RUN mkdir /scripts
COPY ["./docker/wait-for-it.sh", "/scripts"]

COPY ["package.json", "package-lock.json", "tsconfig.json", "/app/"]

RUN mkdir /app/src

COPY ["./src/", "/app/src/"]

RUN npm install
RUN npm run tsc